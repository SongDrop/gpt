2025-07-15 22:42:56,061 - config - INFO - Starting configutation initialization...
2025-07-15 22:42:56,062 - config - INFO - .env file found at: /Users/gabrielmajorsky/Documents/dev-json/unrealstudio3/__________win10dev.xyz/gpt/gpt/backend/.env
2025-07-15 22:42:56,062 - config - INFO - Working directory: /Users/gabrielmajorsky/Documents/dev-json/unrealstudio3/__________win10dev.xyz/gpt/gpt/backend
2025-07-15 22:42:56,062 - config - INFO - .env path resolved: /Users/gabrielmajorsky/Documents/dev-json/unrealstudio3/__________win10dev.xyz/gpt/gpt/backend/.env
2025-07-15 22:42:56,062 - config - INFO - .env exists: True
2025-07-15 22:42:56,069 - config - INFO - Loading settings...
2025-07-15 22:42:56,078 - config - INFO - Loaded configuration:
2025-07-15 22:42:56,078 - config - INFO - App Name: AI Chat Assistant
2025-07-15 22:42:56,078 - config - INFO - Environment: production
2025-07-15 22:42:56,078 - config - INFO - CORS Origins: ['https://localhost:8000', 'http://localhost:8000', 'http://localhost:3000', 'https://localhost:3000']
2025-07-15 22:42:56,078 - config - INFO - Vector Search Enabled: True
2025-07-15 22:42:56,078 - config - INFO - Vector Search Endpoint: https://ragaisearchrtx.search.windows.net/
2025-07-15 22:42:56,078 - config - INFO - Vector Search Key: ***LRZH
2025-07-15 22:42:56,078 - config - INFO - Vector Search Index: rag-1752519055977
2025-07-15 22:42:56,078 - config - INFO - Vector Search Embedding Deployment: text-embedding-ada-002
2025-07-15 22:42:56,078 - config - INFO - Vector Search Embedding Key: ***Hc9F
2025-07-15 22:42:56,078 - config - INFO - Vector search is enabled
2025-07-15 22:42:56,078 - config - INFO - Final vector search configuration check:
2025-07-15 22:42:56,078 - config - INFO - Vector Search Enabled: True
2025-07-15 22:42:56,078 - config - INFO - Vector Search Endpoint: https://ragaisearchrtx.search.windows.net/
2025-07-15 22:42:56,078 - config - INFO - Vector Search Key: ***LRZH
2025-07-15 22:42:56,078 - config - INFO - Vector Search Index: rag-1752519055977
2025-07-15 22:42:56,552 - main - INFO - Starting application initialization...
2025-07-15 22:42:56,572 - main - INFO - Configured CORS origins: ['https://localhost:8000', 'http://localhost:8000', 'http://localhost:3000', 'https://localhost:3000']
INFO:     Started server process [26090]
INFO:     Waiting for application startup.
2025-07-15 22:42:56,581 - main - INFO - Validating OpenAI configuration...
2025-07-15 22:42:56,581 - main - INFO - API Base: https://gabz-mb97c15u-swedencentral.cognitiveservices.azure.com/openai/deployments/gpt-4.1-mini/chat/completions?api-version=2025-01-01-preview
2025-07-15 22:42:56,581 - main - INFO - API Version: 2023-05-15
2025-07-15 22:42:56,581 - main - INFO - Deployment Name: gpt-4.1-mini
2025-07-15 22:42:57,429 - httpx - INFO - HTTP Request: POST https://gabz-mb97c15u-swedencentral.cognitiveservices.azure.com/openai/deployments/gpt-4.1-mini/chat/completions?api-version=2024-05-01-preview "HTTP/1.1 200 OK"
2025-07-15 22:42:57,437 - main - INFO - OpenAI configuration validated successfully
INFO:     Application startup complete.
INFO:     Uvicorn running on http://127.0.0.1:8000 (Press CTRL+C to quit)
2025-07-15 22:43:08,340 - main - INFO - WebSocket connection attempt from 127.0.0.1:51271
INFO:     ('127.0.0.1', 51271) - "WebSocket /ws" [accepted]
2025-07-15 22:43:08,341 - main - INFO - Client 127.0.0.1:51271 connected. Active connections: 1
INFO:     connection open
INFO:     127.0.0.1:51272 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:51272 - "GET /health HTTP/1.1" 200 OK
2025-07-15 22:43:10,606 - main - INFO - Received WebSocket message
2025-07-15 22:43:10,607 - main - INFO - Vector search enabled with index: rag-1752519055977
2025-07-15 22:43:11,782 - httpx - INFO - HTTP Request: POST https://gabz-mb97c15u-swedencentral.cognitiveservices.azure.com/openai/deployments/gpt-4.1-mini/chat/completions?api-version=2024-05-01-preview "HTTP/1.1 200 OK"
2025-07-15 22:43:11,955 - main - INFO - Client 127.0.0.1:51271 disconnected. Active connections: 0
2025-07-15 22:43:11,955 - main - INFO - Connection cleaned up for 127.0.0.1:51271
2025-07-15 22:43:11,956 - main - ERROR - Unexpected error for 127.0.0.1:51271: WebSocket is not connected. Need to call "accept" first.
2025-07-15 22:43:11,957 - main - INFO - Client 127.0.0.1:51271 disconnected. Active connections: 0
2025-07-15 22:43:11,957 - main - INFO - Connection cleaned up for 127.0.0.1:51271
2025-07-15 22:43:11,957 - main - INFO - Client 127.0.0.1:51271 disconnected. Active connections: 0
INFO:     connection closed
2025-07-15 22:43:11,959 - main - INFO - WebSocket connection attempt from 127.0.0.1:51277
INFO:     ('127.0.0.1', 51277) - "WebSocket /ws" [accepted]
2025-07-15 22:43:11,959 - main - INFO - Client 127.0.0.1:51277 connected. Active connections: 1
INFO:     connection open
2025-07-15 22:53:38,383 - main - INFO - WebSocket disconnected: 127.0.0.1:51277
2025-07-15 22:53:38,383 - main - INFO - Client 127.0.0.1:51277 disconnected. Active connections: 0
2025-07-15 22:53:38,384 - main - INFO - Connection cleaned up for 127.0.0.1:51277
2025-07-15 22:53:38,384 - main - INFO - Client 127.0.0.1:51277 disconnected. Active connections: 0
INFO:     connection closed
INFO:     127.0.0.1:51661 - "OPTIONS /chat HTTP/1.1" 200 OK
2025-07-15 23:15:09,545 - main - INFO - Received chat request
2025-07-15 23:15:09,546 - main - INFO - Using vector search for this chat request
2025-07-15 23:15:09,546 - main - INFO - Vector search enabled with index: rag-1752519055977
2025-07-15 23:15:12,505 - httpx - INFO - HTTP Request: POST https://gabz-mb97c15u-swedencentral.cognitiveservices.azure.com/openai/deployments/gpt-4.1-mini/chat/completions?api-version=2024-05-01-preview "HTTP/1.1 200 OK"
2025-07-15 23:15:12,506 - main - INFO - Successfully processed chat request
INFO:     127.0.0.1:51661 - "POST /chat HTTP/1.1" 200 OK
INFO:     127.0.0.1:51663 - "OPTIONS /chat HTTP/1.1" 200 OK
2025-07-15 23:15:25,533 - main - INFO - Received chat request
2025-07-15 23:15:25,533 - main - INFO - Using vector search for this chat request
2025-07-15 23:15:25,534 - main - INFO - Vector search enabled with index: rag-1752519055977
2025-07-15 23:15:28,070 - httpx - INFO - HTTP Request: POST https://gabz-mb97c15u-swedencentral.cognitiveservices.azure.com/openai/deployments/gpt-4.1-mini/chat/completions?api-version=2024-05-01-preview "HTTP/1.1 200 OK"
2025-07-15 23:15:28,072 - main - INFO - Successfully processed chat request
INFO:     127.0.0.1:51663 - "POST /chat HTTP/1.1" 200 OK
INFO:     127.0.0.1:51797 - "GET / HTTP/1.1" 200 OK
INFO:     127.0.0.1:51798 - "GET /favicon.ico HTTP/1.1" 404 Not Found
INFO:     127.0.0.1:52268 - "OPTIONS /chat HTTP/1.1" 200 OK
2025-07-16 00:28:37,595 - main - INFO - Received chat request
2025-07-16 00:28:37,596 - main - INFO - Using vector search for this chat request
2025-07-16 00:28:37,596 - main - INFO - Vector search enabled with index: rag-1752519055977
2025-07-16 00:28:40,559 - httpx - INFO - HTTP Request: POST https://gabz-mb97c15u-swedencentral.cognitiveservices.azure.com/openai/deployments/gpt-4.1-mini/chat/completions?api-version=2024-05-01-preview "HTTP/1.1 200 OK"
2025-07-16 00:28:40,561 - main - INFO - Successfully processed chat request
INFO:     127.0.0.1:52268 - "POST /chat HTTP/1.1" 200 OK
2025-07-16 00:37:17,389 - main - INFO - WebSocket connection attempt from 127.0.0.1:52283
INFO:     ('127.0.0.1', 52283) - "WebSocket /ws" [accepted]
2025-07-16 00:37:17,391 - main - INFO - Client 127.0.0.1:52283 connected. Active connections: 1
INFO:     connection open
INFO:     127.0.0.1:52284 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:52285 - "GET /health HTTP/1.1" 200 OK
2025-07-16 00:37:17,472 - main - INFO - WebSocket disconnected: 127.0.0.1:52283
2025-07-16 00:37:17,472 - main - INFO - Client 127.0.0.1:52283 disconnected. Active connections: 0
2025-07-16 00:37:17,472 - main - INFO - Connection cleaned up for 127.0.0.1:52283
2025-07-16 00:37:17,473 - main - INFO - Client 127.0.0.1:52283 disconnected. Active connections: 0
INFO:     connection closed
2025-07-16 00:37:17,926 - main - INFO - WebSocket connection attempt from 127.0.0.1:52289
INFO:     ('127.0.0.1', 52289) - "WebSocket /ws" [accepted]
2025-07-16 00:37:17,927 - main - INFO - Client 127.0.0.1:52289 connected. Active connections: 1
INFO:     connection open
INFO:     127.0.0.1:52284 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:52285 - "GET /health HTTP/1.1" 200 OK
2025-07-16 00:37:22,654 - main - INFO - Received WebSocket message
2025-07-16 00:37:22,655 - main - INFO - Vector search enabled with index: rag-1752519055977
2025-07-16 00:37:25,566 - httpx - INFO - HTTP Request: POST https://gabz-mb97c15u-swedencentral.cognitiveservices.azure.com/openai/deployments/gpt-4.1-mini/chat/completions?api-version=2024-05-01-preview "HTTP/1.1 200 OK"
2025-07-16 00:37:27,611 - main - INFO - Client 127.0.0.1:52289 disconnected. Active connections: 0
2025-07-16 00:37:27,611 - main - INFO - Connection cleaned up for 127.0.0.1:52289
2025-07-16 00:37:27,611 - main - ERROR - Unexpected error for 127.0.0.1:52289: WebSocket is not connected. Need to call "accept" first.
2025-07-16 00:37:27,611 - main - INFO - Client 127.0.0.1:52289 disconnected. Active connections: 0
2025-07-16 00:37:27,611 - main - INFO - Connection cleaned up for 127.0.0.1:52289
2025-07-16 00:37:27,611 - main - INFO - Client 127.0.0.1:52289 disconnected. Active connections: 0
INFO:     connection closed
2025-07-16 00:37:27,684 - main - INFO - WebSocket connection attempt from 127.0.0.1:52291
INFO:     ('127.0.0.1', 52291) - "WebSocket /ws" [accepted]
2025-07-16 00:37:27,685 - main - INFO - Client 127.0.0.1:52291 connected. Active connections: 1
INFO:     connection open
INFO:     127.0.0.1:52292 - "OPTIONS /chat HTTP/1.1" 200 OK
2025-07-16 00:37:33,884 - main - INFO - Received chat request
2025-07-16 00:37:33,884 - main - INFO - Using vector search for this chat request
2025-07-16 00:37:33,884 - main - INFO - Vector search enabled with index: rag-1752519055977
2025-07-16 00:37:38,982 - httpx - INFO - HTTP Request: POST https://gabz-mb97c15u-swedencentral.cognitiveservices.azure.com/openai/deployments/gpt-4.1-mini/chat/completions?api-version=2024-05-01-preview "HTTP/1.1 200 OK"
2025-07-16 00:37:38,984 - main - INFO - Successfully processed chat request
INFO:     127.0.0.1:52292 - "POST /chat HTTP/1.1" 200 OK
2025-07-16 00:37:53,155 - main - INFO - WebSocket disconnected: 127.0.0.1:52291
2025-07-16 00:37:53,155 - main - INFO - Client 127.0.0.1:52291 disconnected. Active connections: 0
2025-07-16 00:37:53,155 - main - INFO - Connection cleaned up for 127.0.0.1:52291
2025-07-16 00:37:53,155 - main - INFO - Client 127.0.0.1:52291 disconnected. Active connections: 0
INFO:     connection closed
2025-07-16 00:37:53,530 - main - INFO - WebSocket connection attempt from 127.0.0.1:52296
INFO:     ('127.0.0.1', 52296) - "WebSocket /ws" [accepted]
2025-07-16 00:37:53,531 - main - INFO - Client 127.0.0.1:52296 connected. Active connections: 1
INFO:     connection open
INFO:     127.0.0.1:52297 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:52297 - "GET /health HTTP/1.1" 200 OK
2025-07-16 00:37:55,323 - main - INFO - WebSocket disconnected: 127.0.0.1:52296
2025-07-16 00:37:55,324 - main - INFO - Client 127.0.0.1:52296 disconnected. Active connections: 0
2025-07-16 00:37:55,324 - main - INFO - Connection cleaned up for 127.0.0.1:52296
2025-07-16 00:37:55,324 - main - INFO - Client 127.0.0.1:52296 disconnected. Active connections: 0
INFO:     connection closed
2025-07-16 00:37:55,333 - main - INFO - WebSocket connection attempt from 127.0.0.1:52299
INFO:     ('127.0.0.1', 52299) - "WebSocket /ws" [accepted]
2025-07-16 00:37:55,334 - main - INFO - Client 127.0.0.1:52299 connected. Active connections: 1
INFO:     connection open
INFO:     127.0.0.1:52300 - "OPTIONS /chat HTTP/1.1" 200 OK
2025-07-16 00:37:57,341 - main - INFO - Received chat request
2025-07-16 00:37:57,341 - main - INFO - Using vector search for this chat request
2025-07-16 00:37:57,341 - main - INFO - Vector search enabled with index: rag-1752519055977
2025-07-16 00:37:59,973 - httpx - INFO - HTTP Request: POST https://gabz-mb97c15u-swedencentral.cognitiveservices.azure.com/openai/deployments/gpt-4.1-mini/chat/completions?api-version=2024-05-01-preview "HTTP/1.1 200 OK"
2025-07-16 00:37:59,974 - main - INFO - Successfully processed chat request
INFO:     127.0.0.1:52300 - "POST /chat HTTP/1.1" 200 OK
INFO:     127.0.0.1:52300 - "OPTIONS /chat HTTP/1.1" 200 OK
2025-07-16 00:38:02,902 - main - INFO - Received chat request
2025-07-16 00:38:02,903 - main - INFO - Using vector search for this chat request
2025-07-16 00:38:02,903 - main - INFO - Vector search enabled with index: rag-1752519055977
2025-07-16 00:38:08,064 - httpx - INFO - HTTP Request: POST https://gabz-mb97c15u-swedencentral.cognitiveservices.azure.com/openai/deployments/gpt-4.1-mini/chat/completions?api-version=2024-05-01-preview "HTTP/1.1 200 OK"
2025-07-16 00:38:08,065 - main - INFO - Successfully processed chat request
INFO:     127.0.0.1:52300 - "POST /chat HTTP/1.1" 200 OK
INFO:     127.0.0.1:52305 - "OPTIONS /chat HTTP/1.1" 200 OK
2025-07-16 00:38:29,924 - main - INFO - Received chat request
2025-07-16 00:38:29,925 - main - INFO - Using vector search for this chat request
2025-07-16 00:38:29,925 - main - INFO - Vector search enabled with index: rag-1752519055977
2025-07-16 00:38:34,273 - httpx - INFO - HTTP Request: POST https://gabz-mb97c15u-swedencentral.cognitiveservices.azure.com/openai/deployments/gpt-4.1-mini/chat/completions?api-version=2024-05-01-preview "HTTP/1.1 200 OK"
2025-07-16 00:38:34,275 - main - INFO - Successfully processed chat request
INFO:     127.0.0.1:52305 - "POST /chat HTTP/1.1" 200 OK
2025-07-16 00:39:21,284 - main - INFO - WebSocket disconnected: 127.0.0.1:52299
2025-07-16 00:39:21,285 - main - INFO - Client 127.0.0.1:52299 disconnected. Active connections: 0
2025-07-16 00:39:21,285 - main - INFO - Connection cleaned up for 127.0.0.1:52299
2025-07-16 00:39:21,285 - main - INFO - Client 127.0.0.1:52299 disconnected. Active connections: 0
INFO:     connection closed
2025-07-16 00:39:21,624 - main - INFO - WebSocket connection attempt from 127.0.0.1:52312
INFO:     ('127.0.0.1', 52312) - "WebSocket /ws" [accepted]
2025-07-16 00:39:21,624 - main - INFO - Client 127.0.0.1:52312 connected. Active connections: 1
INFO:     connection open
INFO:     127.0.0.1:52313 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:52313 - "GET /health HTTP/1.1" 200 OK
2025-07-16 00:39:23,291 - main - INFO - WebSocket disconnected: 127.0.0.1:52312
2025-07-16 00:39:23,291 - main - INFO - Client 127.0.0.1:52312 disconnected. Active connections: 0
2025-07-16 00:39:23,291 - main - INFO - Connection cleaned up for 127.0.0.1:52312
2025-07-16 00:39:23,291 - main - INFO - Client 127.0.0.1:52312 disconnected. Active connections: 0
INFO:     connection closed
2025-07-16 00:39:23,611 - main - INFO - WebSocket connection attempt from 127.0.0.1:52316
INFO:     ('127.0.0.1', 52316) - "WebSocket /ws" [accepted]
2025-07-16 00:39:23,613 - main - INFO - Client 127.0.0.1:52316 connected. Active connections: 1
INFO:     connection open
INFO:     127.0.0.1:52313 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:52313 - "GET /health HTTP/1.1" 200 OK
2025-07-16 00:39:53,625 - main - INFO - Received WebSocket message
2025-07-16 00:39:53,625 - main - INFO - Vector search enabled with index: rag-1752519055977
2025-07-16 00:39:53,887 - httpx - INFO - HTTP Request: POST https://gabz-mb97c15u-swedencentral.cognitiveservices.azure.com/openai/deployments/gpt-4.1-mini/chat/completions?api-version=2024-05-01-preview "HTTP/1.1 400 Bad Request"
2025-07-16 00:39:53,889 - main - ERROR - OpenAI API error: Error code: 400 - {'error': {'requestid': 'b8816604-2291-4f38-a1c6-7c96046e94e1', 'code': 400, 'message': 'Invalid message request body. Learn how to use Completions extension API, please refer to https://learn.microsoft.com/azure/ai-services/openai/reference#completions-extensions'}}
2025-07-16 00:39:53,889 - main - ERROR - Error code: 400 - {'error': {'requestid': 'b8816604-2291-4f38-a1c6-7c96046e94e1', 'code': 400, 'message': 'Invalid message request body. Learn how to use Completions extension API, please refer to https://learn.microsoft.com/azure/ai-services/openai/reference#completions-extensions'}}
Traceback (most recent call last):
  File "/Users/gabrielmajorsky/Documents/dev-json/unrealstudio3/__________win10dev.xyz/gpt/gpt/backend/main.py", line 750, in websocket_endpoint
    pass
  File "/Users/gabrielmajorsky/Documents/dev-json/unrealstudio3/__________win10dev.xyz/gpt/gpt/backend/main.py", line 729, in process_stream
    )
  File "/Users/gabrielmajorsky/Documents/dev-json/unrealstudio3/__________win10dev.xyz/gpt/gpt/backend/main.py", line 629, in stream_generator
    async def stream_generator(stream, stop_event: asyncio.Event, min_buffer_length: int = 50):
  File "/Users/gabrielmajorsky/Documents/dev-json/unrealstudio3/__________win10dev.xyz/gpt/gpt/backend/main.py", line 246, in stream_generator
    async def stream_generator():
  File "/Users/gabrielmajorsky/Documents/dev-json/unrealstudio3/__________win10dev.xyz/gpt/gpt/backend/venv/lib/python3.8/site-packages/openai/_utils/_utils.py", line 287, in wrapper
    return func(*args, **kwargs)
  File "/Users/gabrielmajorsky/Documents/dev-json/unrealstudio3/__________win10dev.xyz/gpt/gpt/backend/venv/lib/python3.8/site-packages/openai/resources/chat/completions/completions.py", line 1087, in create
    return self._post(
  File "/Users/gabrielmajorsky/Documents/dev-json/unrealstudio3/__________win10dev.xyz/gpt/gpt/backend/venv/lib/python3.8/site-packages/openai/_base_client.py", line 1256, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
  File "/Users/gabrielmajorsky/Documents/dev-json/unrealstudio3/__________win10dev.xyz/gpt/gpt/backend/venv/lib/python3.8/site-packages/openai/_base_client.py", line 1044, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'requestid': 'b8816604-2291-4f38-a1c6-7c96046e94e1', 'code': 400, 'message': 'Invalid message request body. Learn how to use Completions extension API, please refer to https://learn.microsoft.com/azure/ai-services/openai/reference#completions-extensions'}}
2025-07-16 00:39:53,932 - main - INFO - Client 127.0.0.1:52316 disconnected. Active connections: 0
2025-07-16 00:39:53,932 - main - INFO - Connection cleaned up for 127.0.0.1:52316
2025-07-16 00:39:53,932 - main - ERROR - Unexpected error for 127.0.0.1:52316: WebSocket is not connected. Need to call "accept" first.
2025-07-16 00:39:53,933 - main - INFO - Client 127.0.0.1:52316 disconnected. Active connections: 0
2025-07-16 00:39:53,933 - main - INFO - Connection cleaned up for 127.0.0.1:52316
2025-07-16 00:39:53,933 - main - INFO - Client 127.0.0.1:52316 disconnected. Active connections: 0
INFO:     connection closed
2025-07-16 00:39:53,943 - main - INFO - WebSocket connection attempt from 127.0.0.1:52318
INFO:     ('127.0.0.1', 52318) - "WebSocket /ws" [accepted]
2025-07-16 00:39:53,944 - main - INFO - Client 127.0.0.1:52318 connected. Active connections: 1
INFO:     connection open
2025-07-16 00:39:58,149 - main - INFO - WebSocket connection attempt from 127.0.0.1:52320
INFO:     ('127.0.0.1', 52320) - "WebSocket /ws" [accepted]
2025-07-16 00:39:58,149 - main - INFO - Client 127.0.0.1:52320 connected. Active connections: 2
INFO:     connection open
Error in stream_generator: Error code: 400 - {'error': {'requestid': 'b8816604-2291-4f38-a1c6-7c96046e94e1', 'code': 400, 'message': 'Invalid message request body. Learn how to use Completions extension API, please refer to https://learn.microsoft.com/azure/ai-services/openai/reference#completions-extensions'}}
INFO:     127.0.0.1:52321 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:52321 - "GET /health HTTP/1.1" 200 OK
2025-07-16 00:40:09,075 - main - INFO - WebSocket disconnected: 127.0.0.1:52318
2025-07-16 00:40:09,076 - main - INFO - Client 127.0.0.1:52318 disconnected. Active connections: 1
2025-07-16 00:40:09,076 - main - INFO - Connection cleaned up for 127.0.0.1:52318
2025-07-16 00:40:09,076 - main - INFO - Client 127.0.0.1:52318 disconnected. Active connections: 1
INFO:     connection closed
2025-07-16 00:40:09,076 - main - INFO - WebSocket disconnected: 127.0.0.1:52320
2025-07-16 00:40:09,076 - main - INFO - Client 127.0.0.1:52320 disconnected. Active connections: 0
2025-07-16 00:40:09,076 - main - INFO - Connection cleaned up for 127.0.0.1:52320
2025-07-16 00:40:09,076 - main - INFO - Client 127.0.0.1:52320 disconnected. Active connections: 0
INFO:     connection closed
2025-07-16 00:40:09,475 - main - INFO - WebSocket connection attempt from 127.0.0.1:52327
INFO:     ('127.0.0.1', 52327) - "WebSocket /ws" [accepted]
2025-07-16 00:40:09,476 - main - INFO - Client 127.0.0.1:52327 connected. Active connections: 1
INFO:     connection open
INFO:     127.0.0.1:52328 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:52328 - "GET /health HTTP/1.1" 200 OK
2025-07-16 00:40:15,361 - main - INFO - WebSocket disconnected: 127.0.0.1:52327
2025-07-16 00:40:15,361 - main - INFO - Client 127.0.0.1:52327 disconnected. Active connections: 0
2025-07-16 00:40:15,361 - main - INFO - Connection cleaned up for 127.0.0.1:52327
2025-07-16 00:40:15,361 - main - INFO - Client 127.0.0.1:52327 disconnected. Active connections: 0
INFO:     connection closed
2025-07-16 00:40:15,709 - main - INFO - WebSocket connection attempt from 127.0.0.1:52332
INFO:     ('127.0.0.1', 52332) - "WebSocket /ws" [accepted]
2025-07-16 00:40:15,709 - main - INFO - Client 127.0.0.1:52332 connected. Active connections: 1
INFO:     connection open
INFO:     127.0.0.1:52333 - "GET /health HTTP/1.1" 200 OK
INFO:     127.0.0.1:52333 - "GET /health HTTP/1.1" 200 OK
2025-07-16 00:40:45,720 - main - INFO - Received WebSocket message
2025-07-16 00:40:45,721 - main - INFO - Vector search enabled with index: rag-1752519055977
2025-07-16 00:40:45,999 - httpx - INFO - HTTP Request: POST https://gabz-mb97c15u-swedencentral.cognitiveservices.azure.com/openai/deployments/gpt-4.1-mini/chat/completions?api-version=2024-05-01-preview "HTTP/1.1 400 Bad Request"
2025-07-16 00:40:46,000 - main - ERROR - OpenAI API error: Error code: 400 - {'error': {'requestid': 'ff906375-0581-40f1-9ad4-ea4b60baca7f', 'code': 400, 'message': 'Invalid message request body. Learn how to use Completions extension API, please refer to https://learn.microsoft.com/azure/ai-services/openai/reference#completions-extensions'}}
2025-07-16 00:40:46,000 - main - ERROR - Error code: 400 - {'error': {'requestid': 'ff906375-0581-40f1-9ad4-ea4b60baca7f', 'code': 400, 'message': 'Invalid message request body. Learn how to use Completions extension API, please refer to https://learn.microsoft.com/azure/ai-services/openai/reference#completions-extensions'}}
Traceback (most recent call last):
  File "/Users/gabrielmajorsky/Documents/dev-json/unrealstudio3/__________win10dev.xyz/gpt/gpt/backend/main.py", line 750, in websocket_endpoint
    pass
  File "/Users/gabrielmajorsky/Documents/dev-json/unrealstudio3/__________win10dev.xyz/gpt/gpt/backend/main.py", line 729, in process_stream
    )
  File "/Users/gabrielmajorsky/Documents/dev-json/unrealstudio3/__________win10dev.xyz/gpt/gpt/backend/main.py", line 629, in stream_generator
    async def stream_generator(stream, stop_event: asyncio.Event, min_buffer_length: int = 50):
  File "/Users/gabrielmajorsky/Documents/dev-json/unrealstudio3/__________win10dev.xyz/gpt/gpt/backend/main.py", line 246, in stream_generator
    async def stream_generator():
  File "/Users/gabrielmajorsky/Documents/dev-json/unrealstudio3/__________win10dev.xyz/gpt/gpt/backend/venv/lib/python3.8/site-packages/openai/_utils/_utils.py", line 287, in wrapper
    return func(*args, **kwargs)
  File "/Users/gabrielmajorsky/Documents/dev-json/unrealstudio3/__________win10dev.xyz/gpt/gpt/backend/venv/lib/python3.8/site-packages/openai/resources/chat/completions/completions.py", line 1087, in create
    return self._post(
  File "/Users/gabrielmajorsky/Documents/dev-json/unrealstudio3/__________win10dev.xyz/gpt/gpt/backend/venv/lib/python3.8/site-packages/openai/_base_client.py", line 1256, in post
    return cast(ResponseT, self.request(cast_to, opts, stream=stream, stream_cls=stream_cls))
  File "/Users/gabrielmajorsky/Documents/dev-json/unrealstudio3/__________win10dev.xyz/gpt/gpt/backend/venv/lib/python3.8/site-packages/openai/_base_client.py", line 1044, in request
    raise self._make_status_error_from_response(err.response) from None
openai.BadRequestError: Error code: 400 - {'error': {'requestid': 'ff906375-0581-40f1-9ad4-ea4b60baca7f', 'code': 400, 'message': 'Invalid message request body. Learn how to use Completions extension API, please refer to https://learn.microsoft.com/azure/ai-services/openai/reference#completions-extensions'}}
2025-07-16 00:40:46,034 - main - INFO - Client 127.0.0.1:52332 disconnected. Active connections: 0
2025-07-16 00:40:46,034 - main - INFO - Connection cleaned up for 127.0.0.1:52332
2025-07-16 00:40:46,034 - main - ERROR - Unexpected error for 127.0.0.1:52332: WebSocket is not connected. Need to call "accept" first.
2025-07-16 00:40:46,034 - main - INFO - Client 127.0.0.1:52332 disconnected. Active connections: 0
2025-07-16 00:40:46,034 - main - INFO - Connection cleaned up for 127.0.0.1:52332
2025-07-16 00:40:46,034 - main - INFO - Client 127.0.0.1:52332 disconnected. Active connections: 0
INFO:     connection closed
2025-07-16 00:40:46,038 - main - INFO - WebSocket connection attempt from 127.0.0.1:52339
INFO:     ('127.0.0.1', 52339) - "WebSocket /ws" [accepted]
2025-07-16 00:40:46,038 - main - INFO - Client 127.0.0.1:52339 connected. Active connections: 1
INFO:     connection open
Error in stream_generator: Error code: 400 - {'error': {'requestid': 'ff906375-0581-40f1-9ad4-ea4b60baca7f', 'code': 400, 'message': 'Invalid message request body. Learn how to use Completions extension API, please refer to https://learn.microsoft.com/azure/ai-services/openai/reference#completions-extensions'}}
INFO:     127.0.0.1:52344 - "OPTIONS /chat HTTP/1.1" 200 OK
2025-07-16 00:41:11,340 - main - INFO - Received chat request
2025-07-16 00:41:11,341 - main - INFO - Using vector search for this chat request
2025-07-16 00:41:11,341 - main - INFO - Vector search enabled with index: rag-1752519055977
2025-07-16 00:41:13,716 - httpx - INFO - HTTP Request: POST https://gabz-mb97c15u-swedencentral.cognitiveservices.azure.com/openai/deployments/gpt-4.1-mini/chat/completions?api-version=2024-05-01-preview "HTTP/1.1 200 OK"
2025-07-16 00:41:13,717 - main - INFO - Successfully processed chat request
INFO:     127.0.0.1:52344 - "POST /chat HTTP/1.1" 200 OK
INFO:     127.0.0.1:52347 - "OPTIONS /chat HTTP/1.1" 200 OK
2025-07-16 00:41:25,185 - main - INFO - Received chat request
2025-07-16 00:41:25,185 - main - INFO - Using vector search for this chat request
2025-07-16 00:41:25,185 - main - INFO - Vector search enabled with index: rag-1752519055977
2025-07-16 00:41:27,268 - httpx - INFO - HTTP Request: POST https://gabz-mb97c15u-swedencentral.cognitiveservices.azure.com/openai/deployments/gpt-4.1-mini/chat/completions?api-version=2024-05-01-preview "HTTP/1.1 200 OK"
2025-07-16 00:41:27,270 - main - INFO - Successfully processed chat request
INFO:     127.0.0.1:52347 - "POST /chat HTTP/1.1" 200 OK
INFO:     127.0.0.1:52347 - "OPTIONS /chat HTTP/1.1" 200 OK
2025-07-16 00:41:32,087 - main - INFO - Received chat request
2025-07-16 00:41:32,088 - main - INFO - Using vector search for this chat request
2025-07-16 00:41:32,088 - main - INFO - Vector search enabled with index: rag-1752519055977
2025-07-16 00:41:34,503 - httpx - INFO - HTTP Request: POST https://gabz-mb97c15u-swedencentral.cognitiveservices.azure.com/openai/deployments/gpt-4.1-mini/chat/completions?api-version=2024-05-01-preview "HTTP/1.1 200 OK"
2025-07-16 00:41:34,505 - main - INFO - Successfully processed chat request
INFO:     127.0.0.1:52347 - "POST /chat HTTP/1.1" 200 OK
INFO:     127.0.0.1:52349 - "OPTIONS /chat HTTP/1.1" 200 OK
2025-07-16 00:41:40,191 - main - INFO - Received chat request
2025-07-16 00:41:40,191 - main - INFO - Using vector search for this chat request
2025-07-16 00:41:40,191 - main - INFO - Vector search enabled with index: rag-1752519055977
2025-07-16 00:41:42,901 - httpx - INFO - HTTP Request: POST https://gabz-mb97c15u-swedencentral.cognitiveservices.azure.com/openai/deployments/gpt-4.1-mini/chat/completions?api-version=2024-05-01-preview "HTTP/1.1 200 OK"
2025-07-16 00:41:42,902 - main - INFO - Successfully processed chat request
INFO:     127.0.0.1:52349 - "POST /chat HTTP/1.1" 200 OK
